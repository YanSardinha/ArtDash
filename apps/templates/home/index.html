{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
<style>
  #quantidade_artigos_curso {
    width: 100%;
    height: 100%;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ ASSETS_ROOT }}/plugins/chart-morris/js/chartjs.js"></script>
<!-- [ Main Content ] start -->
<div class="pcoded-main-container">
  <div class="pcoded-wrapper">

    <div class="pcoded-content">
      <div class="pcoded-inner-content">
        <!-- [ breadcrumb ] start -->

        <!-- [ breadcrumb ] end -->
        <div class="main-body">
          <div class="page-wrapper">
            <!-- [ Main Content ] start -->
            <div class="row">
              <!--[ Quantidade de Artigos ] start-->
              <div class="col-md-6 col-xl-4">
                <div class="card daily-sales">
                  <div class="card-block">
                    <h6 class="mb-4">Quantidade de Artigos</h6>
                    <div class="row d-flex align-items-center">
                      <div class="col-9">
                        <h3 id="quantidadeArtigos" class="f-w-300 d-flex align-items-center m-b-0"></h3>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!--[ Quantidade de Artigos ] end-->
              <!--[ Quantidade de Orientadores ] starts-->
              <div class="col-md-6 col-xl-4">
                <div class="card Monthly-sales">
                  <div class="card-block">
                    <h6 class="mb-4">Quantidade de Orientadores</h6>
                    <div class="row d-flex align-items-center">
                      <div class="col-9">
                        <h3 id="quantidadeOrientadores" class="f-w-300 d-flex align-items-center  m-b-0"></h3>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!--[ Quantidade de Orientadores ] end-->
              <!--[ Quantidade de Autores ] starts-->
              <div class="col-md-12 col-xl-4">
                <div class="card yearly-sales">
                  <div class="card-block">
                    <h6 class="mb-4">Quantidade de Autores</h6>
                    <div class="row d-flex align-items-center">
                      <div class="col-9">
                        <h3 id="quantidadeAutores" class="f-w-300 d-flex align-items-center  m-b-0"></h3>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!--[ Quantidade de Autores ] end-->
              <!--[ Recent Users ] start-->
              <div class="col-xl-8 col-md-6">
                <div class="card Recent-Users">
                  <div class="card-header">
                    <h5>Quantidade de Artigos por Curso</h5>
                  </div>
                  <div class="card-block px-0 py-3">
                    <canvas id="quantidade_artigos_curso"></canvas>
                  </div>
                </div>
              </div>
              <!--[ Recent Users ] end-->

              <!-- [ statistics year chart ] start -->
              <div class="col-xl-4 col-md-6">
                <div class="card card-event">
                  <div class="card-block">
                    <div class="row align-items-center justify-content-center">
                      <div class="col">
                        <h5 class="m-0">Quantidade de Artigos</h5>
                      </div>
                      <div class="col-auto">
                        <label class="label theme-bg2 text-white f-14 f-w-400 float-right">34%</label>
                      </div>
                    </div>
                    <h2 class="mt-3 f-w-300">45<sub class="text-muted f-14">Competitors</sub></h2>
                    <h6 class="text-muted mt-4 mb-0">You can participate in event </h6>
                    <i class="fab fa-angellist text-c-purple f-50"></i>
                  </div>
                </div>
                <div class="card">
                  <div class="card-block border-bottom">
                    <div class="row d-flex align-items-center">
                      <div class="col-auto">
                        <i class="feather icon-zap f-30 text-c-green"></i>
                      </div>
                      <div class="col">
                        <h3 class="f-w-300">235</h3>
                        <span class="d-block text-uppercase">Quantidade de Orientadores</span>
                      </div>
                    </div>
                  </div>
                  <div class="card-block">
                    <div class="row d-flex align-items-center">
                      <div class="col-auto">
                        <i class="feather icon-map-pin f-30 text-c-blue"></i>
                      </div>
                      <div class="col">
                        <h3 class="f-w-300">26</h3>
                        <span class="d-block text-uppercase">Quantidade de Autores</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- [ statistics year chart ] end -->
              <!--[social-media section] start-->
              <div class="col-md-12 col-xl-4">
                <div class="card card-social">
                  <div class="card-block border-bottom">
                    <div class="row align-items-center justify-content-center">
                      <div class="col-auto">
                        <i class="fab fa-facebook-f text-primary f-36"></i>
                      </div>
                      <div class="col text-right">
                        <h3>12,281</h3>
                        <h5 class="text-c-green mb-0">+7.2% <span class="text-muted">Total Likes</span></h5>
                      </div>
                    </div>
                  </div>
                  <div class="card-block">
                    <div class="row align-items-center justify-content-center card-active">
                      <div class="col-6">
                        <h6 class="text-center m-b-10"><span class="text-muted m-r-5">Target:</span>35,098</h6>
                        <div class="progress">
                          <div class="progress-bar progress-c-theme" role="progressbar" style="width:60%;height:6px;"
                            aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                      </div>
                      <div class="col-6">
                        <h6 class="text-center  m-b-10"><span class="text-muted m-r-5">Duration:</span>3,539</h6>
                        <div class="progress">
                          <div class="progress-bar progress-c-theme2" role="progressbar" style="width:45%;height:6px;"
                            aria-valuenow="45" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xl-4">
                <div class="card card-social">
                  <div class="card-block border-bottom">
                    <div class="row align-items-center justify-content-center">
                      <div class="col-auto">
                        <i class="fab fa-twitter text-c-blue f-36"></i>
                      </div>
                      <div class="col text-right">
                        <h3>11,200</h3>
                        <h5 class="text-c-purple mb-0">+6.2% <span class="text-muted">Total Likes</span>
                        </h5>
                      </div>
                    </div>
                  </div>
                  <div class="card-block">
                    <div class="row align-items-center justify-content-center card-active">
                      <div class="col-6">
                        <h6 class="text-center m-b-10"><span class="text-muted m-r-5">Target:</span>34,185</h6>
                        <div class="progress">
                          <div class="progress-bar progress-c-green" role="progressbar" style="width:40%;height:6px;"
                            aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                      </div>
                      <div class="col-6">
                        <h6 class="text-center  m-b-10"><span class="text-muted m-r-5">Duration:</span>4,567</h6>
                        <div class="progress">
                          <div class="progress-bar progress-c-blue" role="progressbar" style="width:70%;height:6px;"
                            aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-xl-4">
                <div class="card card-social">
                  <div class="card-block border-bottom">
                    <div class="row align-items-center justify-content-center">
                      <div class="col-auto">
                        <i class="fab fa-google-plus-g text-c-red f-36"></i>
                      </div>
                      <div class="col text-right">
                        <h3>10,500</h3>
                        <h5 class="text-c-blue mb-0">+5.9% <span class="text-muted">Total Likes</span></h5>
                      </div>
                    </div>
                  </div>
                  <div class="card-block">
                    <div class="row align-items-center justify-content-center card-active">
                      <div class="col-6">
                        <h6 class="text-center m-b-10"><span class="text-muted m-r-5">Target:</span>25,998</h6>
                        <div class="progress">
                          <div class="progress-bar progress-c-theme" role="progressbar" style="width:80%;height:6px;"
                            aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                      </div>
                      <div class="col-6">
                        <h6 class="text-center  m-b-10"><span class="text-muted m-r-5">Duration:</span>7,753</h6>
                        <div class="progress">
                          <div class="progress-bar progress-c-theme2" role="progressbar" style="width:50%;height:6px;"
                            aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- [ Main Content ] end -->
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
<!-- [ Main Content ] end -->

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script type="text/javascript">
  $(document).ready(function () {
    $.ajax({
      url: "{% url 'lista_orientadores' %}",
      type: 'GET',
      success: function (res) {
        var quantidadeOrientadores = document.getElementById('quantidadeOrientadores');
        quantidadeOrientadores.textContent = res.length;
      }
    });
  });
</script>
<script type="text/javascript">
  $(document).ready(function () {
    $.ajax({
      url: "{% url 'relatorio_quantidade_de_artigos' %}",
      type: 'GET',
      success: function (res) {
        var quantidadeArtigos = document.getElementById('quantidadeArtigos');
        quantidadeArtigos.textContent = res.quantidade;
      }
    });
  });
</script>
<script type="text/javascript">
  $(document).ready(function () {
    $.ajax({
      url: "{% url 'relatorio_quantidade_de_autores' %}",
      type: 'GET',
      success: function (res) {
        var quantidadeAutores = document.getElementById('quantidadeAutores');
        quantidadeAutores.textContent = res.quantidade;
      }
    });
  });
</script>

<script type="text/javascript">
var myChart;

function atualizaGrafico() {
    const url = "{% url 'relatorio_artigos_por_curso' %}";
    fetch(url, {
        method: "get",
    })
    .then(function (result) {
        return result.json();
    })
    .then(function (data) {
        const ctx = document
            .getElementById("quantidade_artigos_curso")
            .getContext("2d");
        var cores_artigos_por_curso = gera_cor((qtd = 12));
        if (myChart) {
            myChart.destroy();
        }
        myChart = new Chart(ctx, {
            type: "bar",
            data: {
                labels: data.cursos,
                datasets: [
                    {
                        label: '# de Artigos',
                        data: data.num_artigos,
                        backgroundColor: cores_artigos_por_curso[0],
                        borderColor: cores_artigos_por_curso[1],
                        borderWidth: 1,
                    },
                ],
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                    },
                },
            },
        });
    });
}

document.addEventListener('DOMContentLoaded', function() {
    atualizaGrafico();
});

</script>


{% endblock javascripts %}